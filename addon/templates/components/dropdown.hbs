{{#if (eq mode "view")}}
  <div data-test-cs-component-view-field-value class="cs-component-dropdown--view-value">
    {{#if showLabelInViewMode}}
      <div data-test-cs-component-view-label>{{label}}</div>
    {{/if}}

    {{#if optionComponent}}
      {{component optionComponent option=selected}}
    {{else}}
      {{selected.name}}
    {{/if}}
  </div>
{{else}}
  <div
    class="{{if multiple "cs-component-dropdown--multiple" "cs-component-dropdown"}} {{if (has-block) "cs-component-dropdown--with-customized-options"}} {{if isOpen "is-open"}} {{@theme}}"
    data-test-cs-component={{dataTestName}}
  >
    <div class="cs-component-dropdown__container">
      {{#if searchAction}}
        {{#if multiple}}
          {{#power-select-multiple
            options=options
            onchange=(or handleChange (action changeAction))
            selected=selected
            search=(action searchAction)
            searchField=searchField
            renderInPlace=true
            onfocus=(action (mut isFocused) true)
            onblur=(action (mut isFocused) false)
            onopen=(action (mut isOpen) true)
            onclose=(action (mut isOpen) false)
            searchEnabled=searchEnabled
            ariaLabel=label
            disabled=disabled
          as |option|}}
            {{get option searchField}}
          {{/power-select-multiple}}
        {{else}}
          {{#power-select
            options=options
            onchange=(or handleChange (action changeAction))
            selected=selected
            search=(action searchAction)
            searchField=searchField
            renderInPlace=true
            onfocus=(action (mut isFocused) true)
            onblur=(action (mut isFocused) false)
            onopen=(action (mut isOpen) true)
            onclose=(action (mut isOpen) false)
            searchEnabled=searchEnabled
            allowClear=allowClear
            ariaLabel=label
            disabled=disabled
          as |option|}}
            {{get option searchField}}
          {{/power-select}}
        {{/if}}
      {{else}}
        {{#if multiple}}
          {{#power-select-multiple
            options=options
            onchange=(or handleChange (action changeAction))
            selected=selected
            searchField=searchField
            renderInPlace=true
            onfocus=(action (mut isFocused) true)
            onblur=(action (mut isFocused) false)
            onopen=(action (mut isOpen) true)
            onclose=(action (mut isOpen) false)
            searchEnabled=searchEnabled
            ariaLabel=label
            disabled=disabled
          as |option|}}
            {{get option searchField}}
          {{/power-select-multiple}}
        {{else}}
          {{#power-select
            options=options
            onchange=(or handleChange (action changeAction))
            selected=selected
            searchField=searchField
            renderInPlace=true
            onfocus=(action (mut isFocused) true)
            onblur=(action (mut isFocused) false)
            onopen=(action (mut isOpen) true)
            onclose=(action (mut isOpen) false)
            searchEnabled=searchEnabled
            allowClear=allowClear
            ariaLabel=label
            disabled=disabled
          as |option|}}
            {{#if optionComponent}}
              {{component optionComponent option=option}}
            {{else if (has-block)}}
              {{yield option}}
            {{else}}
              {{get option searchField}}
            {{/if}}
          {{/power-select}}
        {{/if}}
      {{/if}}
      <label
        class="cs-component-dropdown--label {{if selected "with-option-selected"}} {{if (or isOpen isFocused) "is-open"}} {{@theme}}"
        data-test-cs-component-label={{dataTestName}}
      >
        {{label}}
      </label>
    </div>
  </div>
{{/if}}

{{!-- TODO: Optional label and validation messages --}}